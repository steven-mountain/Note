PDB语法（B站码农高天）

### 基本设置

在对源代码有控制权的时候，在感兴趣的地方加入**breakpoint()**（相当于原来的print），在运行代码，就会进入pdb命令行。

然后会有两行信息：

+ 第一行包含（绝对路径，所处代码的行数（breakpoint的下一行），在哪个函数里）
+ 第二行，便是即将运行的代码



---



### Pdb语法：

#### 检视当前程序状态

+ 打印变量：`p x`（打印x变量， p代表print）
  + 打印的内容可以是任何一个合法的python expression
  + 打印变量，会从当前帧的局部变量先找
  + `u` 或者 `up` 命令往上调整当前帧
  + `d` 或者 `down` 往下调整
+ 查看调用栈：`w` （或者`where`），python里是从上往下调用的
  + 查看调用栈的时候，当前frame最左边会有一个`>`
+ 查看当前位置附近的源代码：
  + `l`（或者`list`），默认打印当前行前后11行代码
  + 再输入`l` 会往下再翻11行
  + `l .` 回到当前行数
  + `ll` longlist，显示当前函数全部的代码



#### 控制程序运行

+ 运行一行程序：`n` 或者 `next` 
  + 如果有函数，next会直接把函数直接调用完
  + 进入函数，`s` 也就是 step，则会进入函数调用
  + next 和 step只有在代码里有函数调用的时候才不一样
+ 获取函数返回值：`retval`
+ 往下运行，直到运行到某一行为止 `until`
  + 意思是运行，直到你到行数比我现在的行数大为止 
  + 用来跳出循环很好使
  + `until` 的参数比如循环在第 10 行跳出，可以 `until 10`，运行到行数大于等于10为止，这样代码会直接跑到第10行
+ 运行到函数返回为止： `r` 或者是 `return`，会让函数停在返回之前
+ 此外，Pdb在debugger里运行任何pyton命令，（改变程序的运行状态）
+ 退出：调试完毕，希望程序继续运行下去 `c` continue



#### 不修改源代码，直接跑Pdb

```bash
# 使用命令行来运行Pdb
python -m pdb example.py

# 会在第一个能停下来的地方停下来
```

+  设置断点，加breakpoint，在源代码里认为的设置断点
+ 在Pdb中设置断点：
  + `b 5`在第五行设置断点
  + 列出所有的断点，`b` 不加参数即可
  + 删除breakpoint，`clear 1`， 1为断点的编号，如果不加1则会删除所有的breakpoint
  + 然后 `c` 会在断点处停下
  + 退出debugger状态：`q` 或者是 `quit`